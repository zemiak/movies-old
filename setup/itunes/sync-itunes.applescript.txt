tell application "iTunes"
	-- start it
	activate
end tell

-- show Home Videos
delay 0.5
set timeoutSeconds to 2.0
set uiScript to "click menu bar item \"View\" of menu bar 1 of application process \"iTunes\"" -- View
my doWithTimeout(uiScript, timeoutSeconds)

delay 0.5
set uiScript to "click menu item 2 of menu 1 of menu bar item \"View\" of menu bar 1 of application process \"iTunes\"" -- Movies
my doWithTimeout(uiScript, timeoutSeconds)

delay 0.5
set uiScript to "keystroke \"a\" using {command down}" -- press Apple+A (select All)
my doWithTimeout(uiScript, timeoutSeconds)

delay 0.5
set uiScript to "key code 51" -- delete
my doWithTimeout(uiScript, timeoutSeconds)

delay 0.5
set uiScript to "key code 36" -- enter
my doWithTimeout(uiScript, timeoutSeconds)


-- Click the “File” menu.
delay 0.5
set uiScript to "click menu bar item \"File\" of menu bar 1 of application process \"iTunes\""
my doWithTimeout(uiScript, timeoutSeconds)

-- Add to Library…
delay 0.5
set uiScript to "click menu item 5 of menu 1 of menu bar item \"File\" of menu bar 1 of application process \"iTunes\""
my doWithTimeout(uiScript, timeoutSeconds)

-- Press Shift Apple G (goto folder)
delay 0.5
set uiScript to "keystroke \"g\" using {shift down, command down}"
my doWithTimeout(uiScript, timeoutSeconds)

-- Type '/Volumes/media/Movies/'
delay 0.5
set uiScript to "keystroke \"/Volumes/media/Movies/\""
my doWithTimeout(uiScript, timeoutSeconds)

-- Press Return
delay 0.5
set timeoutSeconds to 2.0
set uiScript to "keystroke \"
\" "
my doWithTimeout(uiScript, timeoutSeconds)

-- Click the “Open” button.
delay 0.5
set timeoutSeconds to 2.0
set uiScript to "click UI Element \"Open\" of window \"Add To Library\" of application process \"iTunes\""
my doWithTimeout(uiScript, timeoutSeconds)

on doWithTimeout(uiScript, timeoutSeconds)
	set endDate to (current date) + timeoutSeconds
	repeat
		try
			run script "tell application \"System Events\"
" & uiScript & "
end tell"
			exit repeat
		on error errorMessage
			if ((current date) > endDate) then
				error "Can not " & uiScript
			end if
		end try
	end repeat
end doWithTimeout
